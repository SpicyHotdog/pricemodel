# 基金价格分析模型
## 模型介绍
* 投資標的：滬深300指數基金聯接（場外基金，非即時價格交易。交易日下午3點前提交，成交價格為當日價格，否則為T+1價格）
* 產品：易方達滬深300ETF聯接C （007339）
* 模型策略簡述：
   * 簡述：在相對低價的位置執行買入，達到絕對值收益時賣出
   * 數據獲取： 
      * 獲取當前交易日該產品的價格，以及由當前交易日開始的過去**252**個交易日（約1年）的歷史價格作為分析
      * 計算歷史1年該產品價格的上四分位、下四分位和中位數的價格
      * 尋找過去一年裏價格的谷底值（輸出結果為一系列谷底值組成的列表）
      * 判斷當前價格處於歷史價格的區間，並做出買入決策
      * 判斷當前價格是否處於歷史谷底價格區間，並做出買入決策
      * 計算買入後的平均持倉成本。 平均持倉成本 = （當前持倉成本 * 當前持有份額 +/-  買入/賣出份額 * 交易價格）/剩余份額
      * 分析當前持有收益率，並做出賣出決策

    * 買入決策：
      * 低價買入策略：
        * 買入前提：有剩餘的流動資金足夠本次買入策略，**且距離上一個買入日期30天以上**
        * 當前交易日價格處於歷史價格的下四分位以下，則執行買入操作。買入金額為買入單次買入步長的2倍（e.g. 總資金10000，單次買入步長為10%即1000元，則買入1000*2=2000元）
        * 當前交易日價格處於歷史價格的下四分位至中位區間，則做埋入，買入金額為單次買入步長的0.5
        * 若不滿足以上兩個條件，不執行買入策略
      * 谷底買入策略：
        * 買入前提：有剩餘的流動資金足夠本次買入策略，**且距離上一個買入日期10天以上**
        * 獲取近一年的谷底價格，尋找谷底價格中的最低值。如果當前價格和谷底價格之間相差的絕對值小於5%，則認為當前價格處在谷底區間，且執行買入操作。買入金額為單次買入步長的2倍
        * 若不滿足以上條件，不執行買入策略
        * 低價買入策略優先於谷底買入策略執行
      * 賣出策略：
        * 買入前提：有足夠的持有份額支持本次賣出策略，且不小於5份
        * 如果當前持有收益率在1% ～ 3% 之間，賣出總持有份額的20%
        * 如果當前收益在3% ～ 5%之間，則賣出總持有份額的80%
        * 如果當前收益大於5%，全部賣出

    * 回測數據：2022年1月到12月按模型執行買入/賣出模擬，計算全年收益率。**不包含買入/賣出手續費**

* 代碼分析
